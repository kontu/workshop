name: 'upload-workshop-item'
description: 'A GitHub Action to upload items to the Steam Workshop'

branding:
  icon: 'upload-cloud'
  color: 'blue'

runs:
  using: 'composite'
  steps:
    - id: setup-steamcmd
      uses: CyberAndrii/setup-steamcmd@v1.1.1
    - id: update_workshop
      env:
        path: ${{ inputs.path }}
        steamAcct: ${{ inputs.steamAcct }}
        steamPasswd: ${{ inputs.steamPasswd }}
        ssfnContents: ${{ inputs.ssfnContents }}
        ssfnFileName: ${{ inputs.ssfnFileName }}
        SteamConfigVDF: ${{ inputs.steamConfigVdf}}
        STEAM_HOME: ${{ steps.setup-steamcmd.outputs.directory }}
        STEAM_CMD: ${{ steps.setup-steamcmd.outputs.executable }}
      run: |
        
        git config --global --add safe.directory /github/workspace
        chmod +x ${{ github.action_path }}/steamupload.sh
        ${{ github.action_path }}/steamupload.sh
      shell: bash
#apt -qq update && apt -qq install -y git --no-install-recommends
inputs:
  path:
    description: "The relative base path of your mods in the repo. Include trailing slash"
    required: true
    default: 'Mods'
  steamAcct:
    description: "Steam account name to login with"
    required: true
  steamPasswd:
    description: "Steam password (use secrets to store)"
    required: true
  ssfnContents:
    description: "base64 of the steam SSFN file that has authorized the account being used. Used for MFA"
    default: 'null'
    required: false
  ssfnFileName:
    description: "SSFN file name specified in the config.vdf that has authorized the account being used. Used for MFA"
    default: 'null'
    required: false
  steamConfigVdf:
    description: "base64 of the steam config vdf generated for the account being used. Used for MFA"
    default: 'null'
    required: false